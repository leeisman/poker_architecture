# 12. MongoDB vs SQL Comparison

本章節對比 MongoDB（NoSQL）與傳統 SQL 資料庫（如 MySQL、PostgreSQL）在資料模型、操作語法、擴展性、交易等方面的差異。此對比有助於系統架構選型及資料設計時的判斷。

---

## 🧱 資料模型比較

| 項目             | MongoDB                         | SQL 資料庫                      |
|------------------|----------------------------------|---------------------------------|
| 資料結構         | 文件導向（BSON）                 | 關聯表格（Row-Based）           |
| Schema            | 動態                            | 嚴格，事先定義                  |
| 嵌套資料         | 支援巢狀結構（Document in Doc）   | 不支援，需額外 table            |
| 關聯             | $lookup（有限）                 | JOIN（彈性）                    |

---

## 💬 查詢語法比較

```js
// MongoDB
db.users.find({ age: { $gte: 18 } });

// SQL
SELECT * FROM users WHERE age >= 18;
```

```js
// MongoDB 嵌套欄位查詢
db.users.find({ "profile.email": /@gmail.com$/ });
```

---

## 🔁 交易與一致性

| 特性             | MongoDB                             | SQL 資料庫                      |
|------------------|--------------------------------------|---------------------------------|
| 交易機制         | 支援多文件交易（4.0 以後）           | 原生支援 ACID                  |
| 強一致性         | 可調整 Read/Write Concern             | 預設強一致性                   |
| 水平擴充         | Sharding 內建支援                    | 通常需額外設計（如分表）       |

---

## 🚀 擴展性與效能

| 面向         | MongoDB                       | SQL 資料庫                  |
|--------------|-------------------------------|-----------------------------|
| 水平擴充     | 原生支援 Sharding              | 通常困難，需手動切分        |
| 寫入吞吐     | 高（適合 log / event）         | 寫入較慢                   |
| 查詢效率     | 快速但有限（取決於 Index 設計）| JOIN 彈性佳但效能依複雜度而異 |

---

## 📌 適用場景建議

| 使用情境               | 建議資料庫       |
|------------------------|------------------|
| 高寫入吞吐 / Event Log | MongoDB          |
| 資料結構彈性 / 嵌套欄位 | MongoDB          |
| 強一致交易 / 金流      | SQL 資料庫        |
| 多關聯報表查詢         | SQL 資料庫        |

---

## 🧠 Staff Engineer 該理解的重點

- MongoDB 適合彈性、分散式、大量寫入的場景，尤其是 NoSQL 原生優勢
- SQL 資料庫仍是嚴謹結構與強交易要求系統的主力
- 兩者並非互斥，可考慮 CQRS / 混合儲存架構搭配使用

---

[← 回到總覽](../Mongo_Summary.md)
